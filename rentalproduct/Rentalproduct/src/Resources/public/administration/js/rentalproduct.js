!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/bundles/rentalproduct/",n(n.s="CRJi")}({CRJi:function(t,e,n){"use strict";n.r(e);var r=n("pvZZ"),o=n.n(r);n("cTSP");function a(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u=Shopware.Data.EntityCollection,s=Shopware,p=s.Component,m=s.Mixin,f=Shopware.Data.Criteria,y=Shopware.Component.getComponentHelper(),_=y.mapState,w=y.mapGetters;p.register("sw-product-detail-rentalproduct",{template:o.a,inject:["repositoryFactory","acl"],mixins:[m.getByName("notification")],data:function(){return{showDeleteModal:!1,newRentalProductData:null,item:null,showContent:!1}},metaInfo:function(){return{title:"RentalProduct"}},computed:l(l(l({},_("swProductDetail",["product"])),w("swProductDetail",["isLoading"])),{},{productRentalProductRepository:function(){return this.repositoryFactory.create("rental_product")},ruleTypeData:function(){var t=new f(1,500);return t.addFilter(f.multi("OR",[f.contains("rule.moduleTypes.types","price"),f.equals("rule.moduleTypes",null)])),t},dayRuleColumns:function(){return[{property:"dayStart",label:"sw-product.rentalProduct.columnFrom",visible:!0,allowResize:!0,primary:!0,rawData:!1,width:"120px"},{property:"dayEnd",label:"sw-product.rentalProduct.columnTo",visible:!0,allowResize:!0,primary:!0,rawData:!1,width:"120px"},{property:"ruleId",label:"sw-product.rentalProduct.columnRule",visible:!0,allowResize:!0,width:"250px",multiLine:!0}]}}),created:function(){this.createdComponent()},methods:{createdComponent:function(){var t=this;this.newRentalProductData=new u(this.productRentalProductRepository.route,this.productRentalProductRepository.entityName,Shopware.Context.api),console.log("product load"),console.log(this.product),console.log("product load done");var e=this.$route.params.id,n=new f;n.addFilter(f.equals("productId",e)),n.addSorting(f.sort("dayStart","ASC")),this.productRentalProductRepository.search(n,Shopware.Context.api).then((function(e){var n=e;n.total>0&&n.forEach((function(e){return t.newRentalProductData.push(e)}))}))},onAddRentalProduct:function(){var t=this.productRentalProductRepository.create(Shopware.Context.api);t.ruleId=null,t.productId=this.product.id,t.dayStart=1,t.dayEnd=null,this.newRentalProductData.push(t),this.product.extensions.rentalProduct=this.newRentalProductData},getStartDayTooltip:function(t,e){return{message:this.$tc("sw-product.rentalProduct.dayDisabledTooltip"),width:275,showDelay:200,disabled:0!==t||1!==e}},onDayEndChange:function(t,e){e.indexOf(t)+1===e.length&&this.createPriceRule(e)},createPriceRule:function(t){var e=this.productRentalProductRepository.create();e.ruleId=t.ruleId,e.productId=this.product.id;var n=Math.max.apply(Math,a(t.map((function(t){return t.dayEnd}))));e.dayStart=n+1,e.dayEnd=null,this.newRentalProductData.push(e),this.product.extensions.rentalProduct=this.newRentalProductData},onDeleteRentalProduct:function(){var t=this,e=this.$route.params.id,n=new f;n.addFilter(f.equals("productId",e)),this.productRentalProductRepository.search(n,Shopware.Context.api).then((function(e){var n=e;n.total>0&&n.forEach((function(e){t.newRentalProductData.pop(e),t.product.extensions.rentalProduct.remove(e.id)}))}))},onSingleRentalProductDelete:function(t){var e=this.newRentalProductData;if(e.length<=1)this.createNotificationError({message:this.$tc("sw-product.rentalProduct.deletionNotPossibleMessage")});else{var n=e.indexOf(t);if(void 0===t.dayEnd||null===t.dayEnd)e[n-1].dayEnd=null;else e[n+1].dayStart=t.dayStart;this.newRentalProductData.remove(t.id)}}}});var h=n("i627"),b=n.n(h),g=(Shopware.Data.EntityCollection,Shopware),v=(g.Component,g.Mixin,Shopware.Data.Criteria,Shopware.Component.getComponentHelper());v.mapState,v.mapGetters;Shopware.Component.override("sw-product-detail",{template:b.a});var P=n("vvdO"),R=n("OnpA");Shopware.Module.register("sw-product-detail-tab-rentalproduct",{snippets:{"de-DE":P,"en-GB":R},routeMiddleware:function(t,e){"sw.product.detail"===e.name&&e.children.push({name:"sw.product.detail.rentalproduct",path:"/sw/product/detail/:id/rentalproduct",component:"sw-product-detail-rentalproduct",meta:{parentPath:"sw.product.index"}}),t(e)}})},ILTK:function(t,e,n){},OnpA:function(t){t.exports=JSON.parse('{"sw-product":{"rentalProduct":{"cardTitle":"Rental Product","buttonAdd":"Add new Days","buttonDelete":"Delete","dayRule":"Rule","columnFrom":"Date from...","columnTo":"to...","columnRule":"Rule","dayDisabledTooltip":"The start value of the first Day has to be 1.","deletionNotPossibleMessage":"At least one day tier needed. Try deleting the entire pricing rule instead.","emptyStateDescription":"There is no Rental Product configured for this product, yet."}}}')},SZ7m:function(t,e,n){"use strict";function r(t,e){for(var n=[],r={},o=0;o<e.length;o++){var a=e[o],d=a[0],i={id:t+":"+o,css:a[1],media:a[2],sourceMap:a[3]};r[d]?r[d].parts.push(i):n.push(r[d]={id:d,parts:[i]})}return n}n.r(e),n.d(e,"default",(function(){return f}));var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var a={},d=o&&(document.head||document.getElementsByTagName("head")[0]),i=null,l=0,c=!1,u=function(){},s=null,p="data-vue-ssr-id",m="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(t,e,n,o){c=n,s=o||{};var d=r(t,e);return y(d),function(e){for(var n=[],o=0;o<d.length;o++){var i=d[o];(l=a[i.id]).refs--,n.push(l)}e?y(d=r(t,e)):d=[];for(o=0;o<n.length;o++){var l;if(0===(l=n[o]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete a[l.id]}}}}function y(t){for(var e=0;e<t.length;e++){var n=t[e],r=a[n.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](n.parts[o]);for(;o<n.parts.length;o++)r.parts.push(w(n.parts[o]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var d=[];for(o=0;o<n.parts.length;o++)d.push(w(n.parts[o]));a[n.id]={id:n.id,refs:1,parts:d}}}}function _(){var t=document.createElement("style");return t.type="text/css",d.appendChild(t),t}function w(t){var e,n,r=document.querySelector("style["+p+'~="'+t.id+'"]');if(r){if(c)return u;r.parentNode.removeChild(r)}if(m){var o=l++;r=i||(i=_()),e=g.bind(null,r,o,!1),n=g.bind(null,r,o,!0)}else r=_(),e=v.bind(null,r),n=function(){r.parentNode.removeChild(r)};return e(t),function(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap)return;e(t=r)}else n()}}var h,b=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join("\n")});function g(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=b(e,o);else{var a=document.createTextNode(o),d=t.childNodes;d[e]&&t.removeChild(d[e]),d.length?t.insertBefore(a,d[e]):t.appendChild(a)}}function v(t,e){var n=e.css,r=e.media,o=e.sourceMap;if(r&&t.setAttribute("media",r),s.ssrId&&t.setAttribute(p,e.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},cTSP:function(t,e,n){var r=n("ILTK");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);(0,n("SZ7m").default)("7205d4c4",r,!0,{})},i627:function(t,e){t.exports="{% block sw_product_detail_content_tabs_reviews %}\n    {% parent %}\n    <sw-tabs-item :route=\"{ name: 'sw.product.detail.rentalproduct', params: { id: $route.params.id } }\" title=\"RentalProduct\">\n        {{ $tc('sw-product.rentalProduct.cardTitle') }}\n    </sw-tabs-item>\n{% endblock %}\n"},pvZZ:function(t,e){t.exports='{% block sw_product_detail_rentalproduct %}\n    <div class="sw-product-detail-rentalproduct">\n        {% block sw_product_detail_rentalproduct_items %}\n{#            {{ newRentalProductData }}#}\n            <sw-container\n                v-if="newRentalProductData && newRentalProductData.length > 0"\n                columns="100%"\n            >\n                <sw-card>\n                    {% block sw_product_detail_rentalproduct_items_card_toolbar %}\n                        <div class="sw-product-detail-context-prices__toolbar">\n                            <sw-container\n                                columns="minmax(50px, max-content) minmax(50px, max-content)"\n                                gap="0 100px"\n                            >\n                                        {% block sw_product_detail_rentalproduct_items_card_toolbar_rule_delete %}\n                                        <sw-button\n                                        v-tooltip="{\n                                            message: $tc(\'sw-privileges.tooltip.warning\'),\n                                            disabled: acl.can(\'product.editor\'),\n                                            showOnDisabledElements: true\n                                        }"\n                                        size="small"\n                                        :disabled="!acl.can(\'product.editor\')"\n                                        @click="onDeleteRentalProduct()"\n                                        >\n                                            {{ $tc(\'sw-product.rentalProduct.buttonDelete\') }}\n                                    </sw-button>\n                                {% endblock %}\n\n                            </sw-container>\n                        </div>\n                    {% endblock %}\n\n                    {% block sw_product_detail_rentalproduct_items_card_dayrule_group_grid %}\n                        <sw-data-grid\n                            :data-source="newRentalProductData"\n                            :columns="dayRuleColumns"\n                             show-settings\n                            :show-selection="false"\n                            :compact-mode="true"\n{#                            :show-actions="false"#}\n{#                            :show-header="true"#}\n                        >\n\n\n                            {% block sw_product_detail_rentalproduct_items_card_dayrule_group_grid_day_start %}\n                                <template\n                                    slot="column-dayStart"\n                                    slot-scope="{ item, itemIndex, compact }"\n                                >\n\n                                    {% block sw_product_detail_rentalproduct_items_card_dayrule_group_grid_day_start_field %}\n                                        <sw-field\n                                            type="number"\n                                            v-model="item.dayStart"\n                                            :size="compact ? \'small\' : \'default\'"\n                                            :disabled="(itemIndex === 0 && item.dayStart === 1) || !acl.can(\'product.editor\')"\n                                            v-tooltip="getStartDayTooltip(itemIndex, item.dayStart)"\n                                            :name="`${item.ruleId}-${item.dayStart}-dayStart`"\n                                            validation="required"\n                                            :min="item[itemIndex - 1] ? item[itemIndex - 1].dayEnd + 1 : 1"\n                                            :max="item.dayEnd ? item.dayEnd : null"\n                                        />\n\n                                    {% endblock %}\n                                </template>\n                            {% endblock %}\n\n                            {% block sw_product_detail_rentalproduct_items_card_dayrule_group_grid_day_end %}\n                                <template\n                                    slot="column-dayEnd"\n                                    slot-scope="{ item, itemIndex, compact }"\n                                >\n                                    {% block sw_product_detail_rentalproduct_items_card_dayrule_group_grid_day_end_field %}\n                                        <sw-field\n                                            v-model="item.dayEnd"\n                                            type="number"\n                                            placeholder="∞"\n                                            :size="compact ? \'small\' : \'default\'"\n                                            :min="item.dayStart"\n                                            :max="newRentalProductData[itemIndex + 1] ? newRentalProductData[itemIndex + 1].dayStart - 1 : null"\n                                            :name="`${item.ruleId}-${item.dayStart}-dayEnd`"\n                                            :validation="item.dayEnd === null || item.dayEnd > item.dayStart"\n                                            :disabled="!acl.can(\'product.editor\')"\n                                            @change="onDayEndChange(item, newRentalProductData)"\n                                        />\n\n                                    {% endblock %}\n                                </template>\n                            {% endblock %}\n\n                            {% block sw_product_detail_rentalproduct_items_card_dayrule_group_grid_day_rule %}\n                            <template\n                                slot="column-ruleId"\n                                slot-scope="{ item, itemIndex, compact }"\n                            >\n                                {% block sw_product_detail_rentalproduct_items_card_dayrule_group_grid_day_rule_field %}\n                                    <sw-entity-single-select\n                                        v-model="item.ruleId"\n                                        entity="rule"\n{#                                        :criteria="ruleTypeData"#}\n                                        :placeholder="$t(\'sw-product.rentalProduct.dayRule\')"\n                                        show-clearable-button>\n                                    </sw-entity-single-select>\n                                {% endblock %}\n                            </template>\n                            {% endblock %}\n\n                            {% block sw_product_detail_rentalproduct_items_card_dayrule_group_grid_actions %}\n                                <template\n                                    slot="actions"\n                                    slot-scope="{ item }"\n                                >\n\n                                    {% block sw_product_detail_rentalproduct_items_card_dayrule_group_grid_actions_delete_field %}\n                                        <sw-context-menu-item\n                                            variant="danger"\n                                            class="product-detail-context-prices__context-delete"\n                                            :disabled="!acl.can(\'product.editor\')"\n                                            @click="onSingleRentalProductDelete(item)"\n\n                                        >\n                                            {{ $tc(\'sw-product.rentalProduct.buttonDelete\') }}\n                                        </sw-context-menu-item>\n                                    {% endblock %}\n\n                                </template>\n                            {% endblock %}\n\n                        </sw-data-grid>\n                    {% endblock %}\n                </sw-card>\n            </sw-container>\n        {% endblock %}\n\n        {% block sw_product_detail_rentalproduct_empty_state %}\n            <sw-card\n                :isLoading="isLoading"\n                class="sw-product-detail-rentalproduct__empty-state"\n                v-else\n            >\n                <template>\n                    <div class="sw-product-detail-rentalproduct__empty-state-inner">\n                        <img :src="\'/administration/static/img/empty-states/products-empty-state.svg\' | asset" alt="">\n\n                        <div class="sw-product-detail-rentalproduct__empty-state-inner--label">\n                            <p>{{ $tc(\'sw-product.rentalProduct.emptyStateDescription\') }}</p>\n                        </div>\n\n                        {% block sw_product_detail_rentalproduct_empty_state_add %}\n                            <sw-button variant="ghost"\n                                       @click="onAddRentalProduct"\n                                       :disabled="false">\n                                {{ $tc(\'sw-product.rentalProduct.buttonAdd\') }}\n                            </sw-button>\n                        {% endblock %}\n                    </div>\n                </template>\n            </sw-card>\n        {% endblock %}\n    </div>\n{% endblock %}\n'},vvdO:function(t){t.exports=JSON.parse('{"sw-product":{"rentalProduct":{"cardTitle":"Rental Product","buttonAdd":"Add new Days","buttonDelete":"Delete","dayRule":"Rule","columnFrom":"Date from...","columnTo":"to...","columnRule":"Rule","dayDisabledTooltip":"The start value of the first Day has to be 1.","deletionNotPossibleMessage":"At least one day tier needed. Try deleting the entire pricing rule instead.","emptyStateDescription":"There is no Rental Product configured for this product, yet."}}}')}});
//# sourceMappingURL=rentalproduct.js.map